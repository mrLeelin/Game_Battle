# 枪豆人 - Roguelike 技能系统设计

## 核心规则
1. 每个肉鸽技能作用于单个玩家，每个角色选择的技能都可以不一样
2. 升级时随机抽取 3 个技能供玩家选择
3. 技能可叠加升级，每级效果递增
4. 技能分为 普通(Common)、稀有(Rare)、史诗(Epic)、**传说(Legendary)** 四个稀有度
5. **技能融合**：当两个指定技能都达到 3 级时，可触发融合，生成传说级技能
6. 技能卡片要要提示等级和融合条件


---

## 技能融合系统 ⚗️

### 融合规则
1. **触发条件**：两个特定技能都达到 **3 级**
2. **融合方式**：升级时如果满足融合条件，会额外出现融合选项
3. **融合结果**：选择融合后，两个原技能消失，获得一个 **传说级** 融合技能
4. **融合技能**：初始为 1 级，可继续升级，最大 3 级

### 融合配方表

#### 🗡️ 攻击类融合
| 技能A (Lv3) | 技能B (Lv3) | 融合技能 | 图标 | 效果 |
|-------------|-------------|----------|------|------|
| 强化 | 暴击 | **毁灭打击** | 💀 | 暴击造成 3 倍伤害，暴击率 +20% |
| 双发 | 散射 | **弹幕风暴** | 🌪️ | 同时发射 8 颗子弹，覆盖 180° 扇形 |
| 穿透 | 闪电链 | **雷霆穿刺** | ⚡ | 穿透敌人时触发闪电链，每次穿透 +1 跳跃 |
| 火焰弹 | 爆炸 | **烈焰爆破** | 🌋 | 爆炸范围 +100%，爆炸区域持续燃烧 3 秒 |
| 强化 | 穿透 | **贯穿之力** | 🔱 | 穿透不减伤害，每次穿透伤害 +50% |
| 暴击 | 闪电链 | **雷神之怒** | 🔱 | 闪电链必定暴击，跳跃次数 +3 |

#### ❄️ 控制类融合
| 技能A (Lv3) | 技能B (Lv3) | 融合技能 | 图标 | 效果 |
|-------------|-------------|----------|------|------|
| 冰冻 | 毒素 | **瘟疫冰霜** | 🦠 | 敌人减速 80% 并持续掉血，效果可叠加 |
| 追踪 | 闪电链 | **雷电猎手** | 🎯 | 闪电链自动追踪最近敌人，范围 +100% |
| 冰冻 | 时间减缓 | **时间冻结** | ⏸️ | 每 15 秒冻结所有敌人 2 秒 |
| 毒素 | 火焰弹 | **腐蚀烈焰** | ☢️ | 燃烧和中毒效果互相增强，伤害 +100% |

#### 🛡️ 生存类融合
| 技能A (Lv3) | 技能B (Lv3) | 融合技能 | 图标 | 效果 |
|-------------|-------------|----------|------|------|
| 护盾 | 吸血 | **生命护盾** | 💎 | 护盾吸收的伤害转化为 HP，护盾上限 +5 |
| 修复 | 再生 | **不死之身** | 🏥 | 每秒恢复 1 HP，HP 低于 30% 时恢复速度 x3 |
| 减伤 | 幽灵船 | **绝对防御** | 🔰 | 受伤时 30% 概率完全免疫，减伤 +30% |
| 护盾 | 复仇 | **荆棘护盾** | 🌹 | 护盾被击破时对周围敌人造成大量伤害 |

#### 🚀 机动类融合
| 技能A (Lv3) | 技能B (Lv3) | 融合技能 | 图标 | 效果 |
|-------------|-------------|----------|------|------|
| 加速 | 弹跳 | **超级弹射** | 🏀 | 子弹弹跳时船只获得加速，弹跳次数 +3 |
| 回旋镖 | 追踪 | **死亡回旋** | 💫 | 回旋子弹追踪敌人，返回时伤害 x2 |
| 加速 | 激光炮 | **光速引擎** | 🛸 | 激光后坐力转化为超级加速，冷却 -50% |

#### ✨ 特殊融合
| 技能A (Lv3) | 技能B (Lv3) | 融合技能 | 图标 | 效果 |
|-------------|-------------|----------|------|------|
| 磁铁 | 黑洞 | **引力场** | 🌀 | 持续吸引经验球和敌人，吸引范围覆盖全屏 |
| 幸运 | 经验加成 | **财富之神** | 👑 | 经验 +100%，技能选择时必出一个史诗技能 |
| 多重射击 | 弹幕 | **全方位火力** | 🎆 | 360° 全方向射击，子弹数量 x2 |
| 电磁脉冲 | 闪电链 | **雷霆领域** | ⚡ | 脉冲触发闪电链，连锁所有被眩晕的敌人 |

---

## 传说技能详情 (Legendary)

### 💀 毁灭打击
- **来源**：强化 Lv3 + 暴击 Lv3
- **基础效果**：暴击造成 3 倍伤害，暴击率 +20%
- **升级效果**：
  - Lv2: 暴击伤害 3.5 倍，暴击率 +30%
  - Lv3: 暴击伤害 4 倍，暴击率 +40%，暴击时产生冲击波

### 🌪️ 弹幕风暴
- **来源**：双发 Lv3 + 散射 Lv3
- **基础效果**：同时发射 8 颗子弹，覆盖 180° 扇形
- **升级效果**：
  - Lv2: 12 颗子弹，覆盖 240°
  - Lv3: 16 颗子弹，覆盖 360°，形成弹幕环

### ⏸️ 时间冻结
- **来源**：冰冻 Lv3 + 时间减缓 Lv3
- **基础效果**：每 15 秒冻结所有敌人 2 秒
- **升级效果**：
  - Lv2: 冻结 3 秒，冷却 12 秒
  - Lv3: 冻结 4 秒，冷却 10 秒，冻结结束时造成伤害

### 💎 生命护盾
- **来源**：护盾 Lv3 + 吸血 Lv3
- **基础效果**：护盾吸收的伤害转化为 HP，护盾上限 +5
- **升级效果**：
  - Lv2: 护盾上限 +8，转化效率 150%
  - Lv3: 护盾上限 +12，转化效率 200%，护盾自动恢复

### 🌀 引力场
- **来源**：磁铁 Lv3 + 黑洞 Lv3
- **基础效果**：持续吸引经验球和敌人，吸引范围覆盖全屏
- **升级效果**：
  - Lv2: 吸引速度 +50%，敌人被吸引时减速
  - Lv3: 吸引速度 +100%，敌人被吸引时持续受伤

---

## 已实现技能

### 基础技能 (Common) - 13个
| 技能 | 图标 | 描述 | 每级效果 | 最大等级 |
|------|------|------|----------|----------|
| 弹跳 | 🔄 | 子弹碰墙反弹 | +1次反弹 | 5 |
| 穿透 | ➡️ | 子弹穿透敌人 | +1个穿透 | 5 |
| 修复 | 💚 | 立即恢复船只HP | +3点HP | 10 |
| 加速 | 💨 | 后坐力移动增强 | +15%速度 | 5 |
| 强化 | 💪 | 提升子弹伤害 | +1伤害 | 5 |
| 快装 | ⚡ | 减少换弹时间 | -12%换弹时间 | 5 |
| 扩容 | 📦 | 增加弹匣容量 | +2发子弹 | 5 |
| 射程 | 🎯 | 子弹飞行距离延长 | +20%射程 | 3 |
| 磁铁 | 🧲 | 增加经验球吸收范围 | +50%吸收范围 | 3 |
| 经验加成 | 📈 | 获得的经验值增加 | +15%经验 | 5 |
| 子弹加速 | 🚀 | 子弹飞行速度提升 | +20%弹速 | 3 |
| 减伤 | 🧱 | 受到的伤害降低 | -10%伤害 | 5 |
| 再生 | 💗 | 每隔一段时间恢复HP | +0.5HP/10秒 | 3 |

### 稀有技能 (Rare) - 15个
| 技能 | 图标 | 描述 | 每级效果 | 最大等级 |
|------|------|------|----------|----------|
| 护盾 | 🛡️ | 获得护盾抵挡伤害 | +1层护盾 | 5 |
| 双发 | ✌️ | 额外发射子弹 | +1颗子弹 | 3 |
| 吸血 | 🩸 | 击杀敌人恢复HP | +1HP/击杀 | 3 |
| 暴击 | 💥 | 有概率造成双倍伤害 | +10%暴击率 | 5 |
| 散射 | 🌟 | 发射扇形散射子弹 | +2颗分散子弹 | 3 |
| 追踪 | 🎯 | 子弹轻微追踪最近敌人 | +15%追踪强度 | 3 |
| 冰冻 | ❄️ | 命中敌人使其减速 | +15%减速效果 | 3 |
| 毒素 | ☠️ | 命中敌人持续掉血 | +1秒持续时间 | 3 |
| 幸运 | 🍀 | 增加稀有技能出现概率 | +10%稀有率 | 3 |
| 火焰弹 | 🔥 | 命中敌人造成燃烧伤害 | +1秒燃烧 | 3 |
| 护盾冲撞 | 💢 | 船只撞击敌人时造成伤害 | +2点撞击伤害 | 3 |
| 连击 | 🔗 | 连续命中增加伤害 | +5%伤害/连击 | 5 |
| 分裂弹 | 💠 | 子弹命中后分裂成小子弹 | +2颗分裂弹 | 3 |
| 回旋镖 | 🪃 | 子弹飞出后返回 | +1次返回 | 2 |
| 弹幕 | 🌀 | 射击时额外发射环绕子弹 | +1颗环绕弹 | 3 |

### 史诗技能 (Epic) - 9个
| 技能 | 图标 | 描述 | 每级效果 | 最大等级 |
|------|------|------|----------|----------|
| 闪电链 | ⚡ | 子弹命中后跳跃至附近敌人 | +1次跳跃 | 3 |
| 爆炸 | 💣 | 子弹命中后产生范围爆炸 | +30%爆炸范围 | 3 |
| 多重射击 | 🔫 | 同时向多个方向射击 | +1个射击方向 | 2 |
| 时间减缓 | ⏳ | 周围敌人移动速度降低 | +10%减速范围 | 3 |
| 电磁脉冲 | 📡 | 定期释放脉冲眩晕周围敌人 | +0.5秒眩晕 | 3 |
| 激光炮 | 🔦 | 每隔一段时间发射激光，有巨大后坐力 | -5秒冷却时间 | 3 |
| 黑洞 | 🕳️ | 击杀敌人生成黑洞吸引周围敌人 | +20%吸引范围 | 2 |
| 幽灵船 | 👻 | 受伤后短暂无敌 | +0.3秒无敌时间 | 3 |
| 复仇 | 😈 | 受伤时对周围敌人造成伤害 | +50%反伤范围 | 3 |

---

## 待实现技能设计

> **注意**：第一至第四阶段的技能已全部实现，仅剩融合系统待实现。

### 第五阶段（融合系统）- 待实现
1. 实现融合检测逻辑
2. 实现融合 UI 界面
3. 实现传说技能效果
4. 平衡性调整

---

## 技能组合推荐

### 输出流 → 融合目标：毁灭打击
- 强化 + 暴击 + 双发 + 散射
- 适合：追求高伤害的玩家

### 控制流 → 融合目标：时间冻结
- 冰冻 + 毒素 + 闪电链 + 时间减缓
- 适合：喜欢控制敌人的玩家

### 生存流 → 融合目标：生命护盾
- 护盾 + 吸血 + 修复 + 减伤 + 再生
- 适合：追求稳定生存的玩家

### 机动流 → 融合目标：超级弹射
- 加速 + 弹跳 + 回旋镖 + 激光炮
- 适合：喜欢高机动性的玩家

### 范围流 → 融合目标：引力场
- 爆炸 + 分裂弹 + 电磁脉冲 + 黑洞 + 磁铁
- 适合：喜欢清怪的玩家

---

## 实现优先级

### 第一阶段（基础技能）✅ 已完成
1. ✅ 经验加成 - 修改经验获取倍率
2. ✅ 子弹加速 - 修改子弹速度
3. ✅ 减伤 - 修改伤害计算
4. ✅ 再生 - 定时恢复HP

### 第二阶段（中等难度）✅ 已完成
1. ✅ 火焰弹 - 添加燃烧状态
2. ✅ 护盾冲撞 - 添加碰撞伤害
3. ✅ 连击 - 添加连击计数器
4. ✅ 时间减缓 - 添加范围减速光环

### 第三阶段（较高难度）✅ 已完成
1. ✅ 分裂弹 - 子弹分裂逻辑
2. ✅ 回旋镖 - 子弹返回逻辑
3. ✅ 弹幕 - 环绕子弹系统
4. ✅ 电磁脉冲 - 范围眩晕效果

### 第四阶段（高难度）✅ 已完成
1. ✅ 激光炮 - 新武器类型
2. ✅ 黑洞 - 物理吸引效果
3. ✅ 幽灵船 - 无敌状态系统
4. ✅ 复仇 - 反伤系统

### 第五阶段（融合系统）⏳ 待实现
1. 实现融合检测逻辑
2. 实现融合 UI 界面
3. 实现传说技能效果
4. 平衡性调整

---

## 技能平衡原则

1. **稀有度与强度对应**：传说 > 史诗 > 稀有 > 普通
2. **融合有代价**：融合后失去两个 3 级技能，需要权衡
3. **有得有失**：强力技能可能有副作用（如激光炮的巨大后坐力）
4. **组合加成**：某些技能组合使用效果更佳
5. **上限控制**：每个技能有最大等级限制，避免无限叠加
6. **选择多样性**：确保每种玩法都有可行的技能组合和融合路线

---

## 更新日志

### 2025-01-31 (第四阶段完成)
- ✅ 实现激光炮技能（自动发射、穿透伤害、巨大后坐力）
- ✅ 实现黑洞技能（击杀生成、吸引敌人）
- ✅ 实现幽灵船技能（受伤后无敌）
- ✅ 实现复仇技能（受伤时反伤）
- 更新已实现技能列表（共37个技能）
- 第一至第四阶段全部完成

### 2025-01-31 (第三阶段完成)
- ✅ 实现分裂弹技能（命中分裂）
- ✅ 实现回旋镖技能（子弹返回）
- ✅ 实现弹幕技能（环绕子弹）
- ✅ 实现电磁脉冲技能（范围眩晕）

### 2025-01-31 (第二阶段完成)
- ✅ 实现火焰弹技能（燃烧伤害）
- ✅ 实现护盾冲撞技能（碰撞伤害）
- ✅ 实现连击技能（连续命中加成）
- ✅ 实现时间减缓技能（范围减速）

### 2025-01-31 (第一阶段完成)
- ✅ 实现经验加成技能
- ✅ 实现子弹加速技能
- ✅ 实现减伤技能
- ✅ 实现再生技能

### 2025-01-31 (初始设计)
- 新增技能融合系统设计
- 新增 18 种融合配方（攻击/控制/生存/机动/特殊）
- 新增传说级技能详情（5 个示例）
- 新增待实现技能设计（16 个新技能）
- 新增技能组合推荐（5 种流派）
- 新增实现优先级规划（5 个阶段）
- 新增技能平衡原则
